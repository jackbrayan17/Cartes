<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <style>
        #map {
            position: absolute;
            top: 0; bottom: 0; left: 0; right: 0;
            width: 100%;
            height: 100%;
        }
        html, body { width: 100%; height: 100%; margin: 0; padding: 0; }
        .leaflet-container { font-size: 1rem; }

        #mapKey {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.92);
            padding: 12px;
            border-radius: 10px;
            font-size: 14px;
            width: 280px;
            max-height: 70vh;
            overflow-y: auto;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        #keyList {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        #keyList li {
            margin: 8px 0;
            padding: 4px;
            border-radius: 4px;
            transition: background 0.2s;
        }
        #keyList li:hover {
            background: #f0f0f0;
            cursor: pointer;
        }

        .numbered-marker .marker-circle {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 3px solid #000;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 13px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>
    <div class="folium-map" id="map"></div>
    <div id="mapKey">
        <h5 style="margin-top:0;">Légende des points</h5>
        <ul id="keyList"></ul>
    </div>
</body>
<script>
    var map = L.map("map", {
        center: [7.0, 12.0],
        zoom: 6,
        zoomControl: true
    });

    L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: '&copy; OpenStreetMap contributors',
        maxZoom: 19
    }).addTo(map);

    // Palette de couleurs (70 couleurs distinctes)
    var colors = [
        '#e6194B','#3cb44b','#ffe119','#4363d8','#f58231','#911eb4','#42d4f4','#f032e6','#bfef45','#fabed4',
        '#469990','#dcbeff','#9A6324','#fffac8','#800000','#aaffc3','#808000','#ffd8b1','#000075','#a9a9a9',
        '#e6194B','#3cb44b','#ffe119','#4363d8','#f58231','#911eb4','#42d4f4','#f032e6','#bfef45','#fabed4',
        '#469990','#dcbeff','#9A6324','#fffac8','#800000','#aaffc3','#808000','#ffd8b1','#000075','#a9a9a9',
        '#e6194B','#3cb44b','#ffe119','#4363d8','#f58231','#911eb4','#42d4f4','#f032e6','#bfef45','#fabed4',
        '#469990','#dcbeff','#9A6324','#fffac8','#800000','#aaffc3','#808000','#ffd8b1','#000075','#a9a9a9',
        '#ffffff','#000000'
    ];

    var locations = [
        {name: "GIC DJOUMA", tel: "—", zone: "Bamguel, Maroua", region: "Extrême-Nord", lat: 10.800000, lng: 14.050000},
        {name: "NDOUMESSI", tel: "—", zone: "Kribi", region: "Sud", lat: 2.925000, lng: 9.916700},
        {name: "GIC PRODUCTEURS DES OIGNONS", tel: "—", zone: "Nord", region: "Nord", lat: 10.610000, lng: 14.370000},
        {name: "GIC PRODUCTEURS DES PEPINIERES DE MAYO-LOUE", tel: "699701299", zone: "Nord", region: "Nord", lat: 8.241056, lng: 13.217425},
        {name: "GIC MADINA DES PRODUCTEURS DES CULTURES MARAICHERES DE BARGARAM", tel: "652591465", zone: "Ilarifa", region: "Extrême-Nord", lat:3.8667, lng: 11.51667},
        {name: "Groupe des élèves de Volaille de Rouge", tel: "676502725", zone: "Donry-BENOUE", region: "Nord", lat: 10.740278, lng: 13.802778},
        {name: "Société coopérative simplifiée des éleveurs de poulet de chair", tel: "691772660", zone: "NASSARAO-GAROUA", region: "Nord", lat: 9.333333, lng: 13.183333},
        {name: "Mandu, à Wawo, épouse Mbakom", tel: "696112432", zone: "Foumbot", region: "Ouest", lat: 5.563333, lng: 10.668333},
        {name: "GROUPE D'INITIATIVE COMMUNE DES PRODUCTEURS ET COMMERCANTS DES FRUITS DU MAYO-DANAY", tel: "698252640", zone: "Caïcaï, quartier Mangal, Maroua", region: "Extrême-Nord", lat: 10.666759, lng: 15.028457},
        {name: "SCOOPS PROD. MAÏS ET OIGNONS KOZA", tel: "696676662", zone: "Caïcaï, quartier Mangal, Maroua", region: "Extrême-Nord", lat: 10.666759, lng: 15.028757}, // +0.0003 en lng
        {name: "SOCIETE COOPERATIVE DES PRODUCTEURS D'OIGNON DE NGONG", tel: "695245414", zone: "Tamoundé", region: "Nord", lat: 9.0233, lng: 13.183333},
        {name: "Société des Producteurs d'Oignons", tel: "69000012", zone: "Dockbar, vers Tamoundé", region: "Nord", lat: 10.733600, lng: 14.609281},
        {name: "NOPING", tel: "691027853", zone: "Douala", region: "Littoral", lat: 4.030000, lng: 9.700000},
        {name: "Sanaga Farms", tel: "699612687", zone: "BAFOUSSAM", region: "Ouest", lat: 5.477750, lng: 10.417589},
        {name: "Madame Saïz épouse Wemny", tel: "677766234", zone: "Yaoundé / Ebolowa", region: "Sud", lat: 2.916664, lng: 11.150000},
        {name: "Coopérative d'éleveurs de canards et poulets de Bupindi", tel: "674853303", zone: "Bipindi", region: "Sud", lat: 3.083333, lng: 10.416664},
        {name: "TIOMELA CLOTILDE", tel: "675151364", zone: "Foumbot", region: "Ouest", lat: 5.383611, lng: 10.656389},
        {name: "GROUPE D'INITIATIVE COMMUNE DE FABRICATION NATURELLE DE YAOURT DU LITTORAL CENTRE", tel: "699788027", zone: "Littoral", region: "Littoral", lat: 4.078833, lng: 9.793694},
        {name: "GIC DES PRODUCTRICES DE MANIOC", tel: "678227820", zone: "Littoral", region: "Littoral", lat: 3.9833, lng: 13.1667},
        {name: "LYCEE DE GARI-GOMBO", tel: "651942556", zone: "Littoral", region: "Littoral", lat: 4.016667, lng: 9.716667},
        {name: "SOC. COOP. AGROPASTORALE DES ACTEURS DU DEVELOPPEMENT DE NITOUKOU", tel: "677750389", zone: "Tshukou", region: "Extrême-Nord", lat: 4.630000, lng: 10.880000},
        {name: "Groupe Initiatives Communes Agropastoral", tel: "677766234", zone: "Foumbot", region: "Ouest", lat: 5.503000, lng: 10.637000},
        {name: "SCOOPS RECOLTE 237 FERME NKOUE", tel: "690767345", zone: "Centre", region: "Centre", lat: 7.365302, lng: 12.343440},
        {name: "SOC. COOP. DES PRODUCTEURS DE PATATE DE BONJONG", tel: "697324852", zone: "Adamaoua", region: "Adamaoua", lat: 6.333661, lng: 13.530711},
        {name: "SCOOPS PTASPL", tel: "656102611", zone: "Yaoundé", region: "Centre", lat: 3.938333, lng: 11.515556},
        {name: "SOC. COOP. PRODUCTEURS DE MANIOC WARACK MADIKOUM", tel: "696492700", zone: "Adamaoua", region: "Adamaoua", lat: 4.00, lng: 11.50}, // Attention : coordonnées étranges → probablement erreur de saisie, je les laisse mais vérifie !
        {name: "Leprince", tel: "698843700", zone: "", region: "", lat: null, lng: null},
        {name: "STE COOP-CA MBANGASSINA", tel: "675493737", zone: "Mbangassina", region: "Centre", lat: 4.629722, lng: 11.706944},
        {name: "SOC. COOP. PRODUCTEURS DE MANIOC SAPE DE BERTOUA", tel: "691977154", zone: "Bertoua", region: "Est", lat: 4.575000, lng: 13.684444},
        {name: "coopacam", tel: "699814462", zone: "Mfou", region: "Centre", lat: 4.450000, lng: 11.633333},
        {name: "SCOOP MAN DE MBALMAYO", tel: "696819231", zone: "Mbalmayo", region: "Centre", lat: 3.516667, lng: 11.500000},
        {name: "Maraiamou", tel: "696255220", zone: "Maroua", region: "Extrême-Nord", lat: 10.583333, lng: 14.316667},
        {name: "Groupe producteur de poisson", tel: "682247271", zone: "Benbis, Sangmelima", region: "Sud", lat: 3.433333, lng: 12.450000},
        {name: "Vente poisson fumé", tel: "695752643", zone: "Bertoua", region: "Est", lat: 4.575000, lng: 13.684744}, // décalé
        {name: "Vente poulet fumé", tel: "695752643", zone: "Bertoua", region: "Est", lat: 4.575300, lng: 13.684444}, // décalé
        {name: "Gic producteur de Haricot", tel: "67038821", zone: "Foumbot", region: "Ouest", lat: 5.503000, lng: 10.637300}, // décalé
        {name: "integrity-fruits", tel: "—", zone: "Douala", region: "Littoral", lat: 4.078889, lng: 9.666667},
        {name: "Gic producteur de poisson Henri Samet", tel: "699909298", zone: "Kribi", region: "Sud", lat: 2.845556, lng: 9.885556},
        {name: "makou-epse-fotsing-delphine", tel: "—", zone: "Douala", region: "Littoral", lat: 4.016667, lng: 9.733333},
        {name: "organisation interprofessionnelle filière lait", tel: "698319292", zone: "Tchabam-Faro", region: "Nord", lat:8.6280141, lng: 12.8026003},
        {name: "Mélanie Tekaneng", tel: "698336566", zone: "Bertoua", region: "Est", lat: 4.575000, lng: 13.684144}, // décalé
        {name: "Moisso-Michel", tel: "694884692", zone: "Kribi", region: "Sud", lat: 2.845556, lng: 9.885856}, // décalé
        {name: "Pompou Mangac", tel: "697181400", zone: "Mbang-Batouri", region: "Est", lat: 4.433333, lng: 14.366667},
        {name: "Société coopérative Ndom Akonolinga", tel: "656028082", zone: "Ndom, Akonolinga", region: "Centre", lat: 3.766667, lng: 12.250000},
        {name: "NYANO Patrice", tel: "699936505", zone: "Nkolbisson, Yaoundé", region: "Centre", lat: 3.871944, lng: 11.455000},
        {name: "KINDAG adlist sarl", tel: "653907949", zone: "Makak", region: "Centre", lat: 3.548611, lng: 11.027778},
        {name: "Société Harris Yaourt", tel: "670100931", zone: "Yaoundé Ngoa-Ekelle", region: "Centre", lat: 3.986111, lng: 11.833056},
        {name: "SCOOPS C.A.B.K.J", tel: "690777710", zone: "Ngaoundéré", region: "Adamaoua", lat: 7.316667, lng: 13.583333},
        {name: "GIC FAPAC DE MFOU", tel: "699989564", zone: "Mfou", region: "Centre", lat: 4.450000, lng: 11.633633}, // décalé légèrement
        {name: "OMBOLO BELLA - GIC JAEO d’Obala", tel: "678200307", zone: "Obala", region: "Centre", lat: 4.166667, lng: 11.533333},
        {name: "ETS AGRITECH YAOUNDE", tel: "670545408", zone: "Yaoundé Odza", region: "Centre", lat: 3.783333, lng: 11.533333},
        {name: "Gic nel-agro", tel: "699959991", zone: "Nkolafamba", region: "Centre", lat: 3.858889, lng: 11.664722},
        {name: "GIC ESPERANCE", tel: "675820484", zone: "", region: "", lat: null, lng: null},
        {name: "GIC AIDONS NOUS D'OBALA", tel: "656529861", zone: "Ekoumdoum", region: "Centre", lat: 3.816667, lng: 11.533333},
        {name: "BANANA GROUP", tel: "677649089", zone: "Simalen, Yaoundé", region: "Centre", lat: 3.720164, lng: 11.551997},
        {name: "SCOOPS SAPAS", tel: "693521000", zone: "Guidè", region: "Nord", lat: 9.7667, lng: 13.9667}, // Tunisie ? Vérifie cette coordonnée !
        {name: "GIC AGRONE de Nanga Eboko", tel: "673434672", zone: "Nanga Eboko", region: "Centre", lat: 4.683333, lng: 12.366667},
        {name: "GIC LA RESERVE", tel: "694169910", zone: "Djoandjila", region: "", lat: null, lng: null},
        {name: "GIC MAIN VERTE", tel: "699428768", zone: "Batchenga", region: "Centre", lat: 4.283333, lng: 11.650000},
        {name: "GIC UNION FAIT LA FORCE DE PANGARI", tel: "677647025", zone: "Pangari", region: "Adamaoua", lat: 6.010000, lng: 13.362500},
        {name: "AGRIDEVERT", tel: "653359507", zone: "Banquim", region: "Adamaoua", lat: 6.283300, lng: 11.133300},
        {name: "GKIBIA AGROPORT", tel: "674158302", zone: "Banquim", region: "Adamaoua", lat: 6.150000, lng: 11.450000},
        {name: "BEGEL SARL", tel: "699771423", zone: "Mindourou", region: "Est", lat: 3.415800, lng: 13.539400},
        {name: "UNION COOP TRANSFORMATEURS LAIT MAROUA 1ER", tel: "696154363", zone: "Maroua", region: "Extrême-Nord", lat: 9.322602, lng: 13.393390},
        {name: "Société Aris Yaourt", tel: "670100931", zone: "Yaoundé Ngoa-Ekelle", region: "Centre", lat: 3.986111, lng: 11.833356}, // décalé
        {name: "GIC GENGAL", tel: "677605789", zone: "Soa", region: "Centre", lat: 3.978056, lng: 11.595833},
        {name: "ONGOLA EDZIMBI EPSE NDJOCK", tel: "691191603", zone: "Fandena", region: "Centre", lat: 3.885278, lng: 11.540833},
        {name: "GIC Niyya femme prod lait MINDIF", tel: "697996495", zone: "Mindif", region: "Extrême-Nord", lat: 10.400000, lng: 14.433333},
        {name: "ATADJAM EPSE BAKARY", tel: "694533232", zone: "Maroua Domayo", region: "Extrême-Nord", lat: 10.550000, lng: 14.150000},
        {name: "DAKGO POLYCARPE", tel: "677003157", zone: "Douala", region: "Littoral", lat: 4.0333, lng: 9.7333} // décalé légèrement
    ];

    // Compteur pour numéroter UNIQUEMENT les marqueurs réellement affichés
    let uniqueNumberCounter = 1;

    // On parcourt toutes les entrées valides (avec coordonnées)
    locations.forEach(function(loc) {
        if (loc.lat === null || loc.lng === null) return; // on ignore ceux sans coordonnées

        // Numéro unique incrémental (indépendant des doublons de position)
        const markerNumber = uniqueNumberCounter++;
        const colorIndex = (markerNumber - 1) % colors.length;
        const borderColor = colors[colorIndex];

        // Création du marqueur numéroté
        const iconHtml = `
            <div class="numbered-marker">
                <div class="marker-circle" style="border-color:${borderColor};background:${borderColor};color:white;">
                    ${markerNumber}
                </div>
            </div>`;

        const customIcon = L.divIcon({
            html: iconHtml,
            className: "",
            iconSize: [34, 34],
            iconAnchor: [17, 34],
            popupAnchor: [0, -34]
        });

        const marker = L.marker([loc.lat, loc.lng], { icon: customIcon }).addTo(map);

        // Popup
        const popupContent = `
            <div style="font-size:14px;">
                <b>${loc.name}</b><br>
                Région : ${loc.region || "—"}<br>
                Zone : ${loc.zone || "—"}<br>
                Tél : ${loc.tel || "—"}
            </div>`;
        marker.bindPopup(popupContent);

        // Ajout dans la légende
        const li = document.createElement("li");
        li.innerHTML = `<span style="display:inline-block;width:20px;text-align:center;color:white;background:${borderColor};border-radius:50%;padding:2px 6px;margin-right:8px;font-weight:bold;">${markerNumber}</span> ${loc.name}`;
        li.style.cursor = "pointer";
        li.onclick = () => {
            map.setView([loc.lat, loc.lng], 14);
            marker.openPopup();
        };
        document.getElementById("keyList").appendChild(li);
    });
</script>
</html>
