<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <style>
        #map {
            position: absolute;
            top: 0; bottom: 0; left: 0; right: 0;
            width: 100%;
            height: 100%;
        }
        html, body { width: 100%; height: 100%; margin: 0; padding: 0; }
        .leaflet-container { font-size: 1rem; }

        #mapKey {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.92);
            padding: 12px;
            border-radius: 10px;
            font-size: 14px;
            width: 280px;
            max-height: 70vh;
            overflow-y: auto;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        #keyList {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        #keyList li {
            margin: 8px 0;
            padding: 4px;
            border-radius: 4px;
            transition: background 0.2s;
        }
        #keyList li:hover {
            background: #f0f0f0;
            cursor: pointer;
        }

        .numbered-marker .marker-circle {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 3px solid #000;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 13px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>
    <div class="folium-map" id="map"></div>
    <div id="mapKey">
        <h5 style="margin-top:0;">Légende des points</h5>
        <ul id="keyList"></ul>
    </div>
</body>
<script>
    var map = L.map("map", {
        center: [7.0, 12.0],
        zoom: 6,
        zoomControl: true
    });

    L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: '&copy; OpenStreetMap contributors',
        maxZoom: 19
    }).addTo(map);

    // Palette de couleurs (70 couleurs distinctes)
    var colors = [
        '#e6194B','#3cb44b','#ffe119','#4363d8','#f58231','#911eb4','#42d4f4','#f032e6','#bfef45','#fabed4',
        '#469990','#dcbeff','#9A6324','#fffac8','#800000','#aaffc3','#808000','#ffd8b1','#000075','#a9a9a9',
        '#e6194B','#3cb44b','#ffe119','#4363d8','#f58231','#911eb4','#42d4f4','#f032e6','#bfef45','#fabed4',
        '#469990','#dcbeff','#9A6324','#fffac8','#800000','#aaffc3','#808000','#ffd8b1','#000075','#a9a9a9',
        '#e6194B','#3cb44b','#ffe119','#4363d8','#f58231','#911eb4','#42d4f4','#f032e6','#bfef45','#fabed4',
        '#469990','#dcbeff','#9A6324','#fffac8','#800000','#aaffc3','#808000','#ffd8b1','#000075','#a9a9a9',
        '#ffffff','#000000'
    ];

    var locations = [
        {name: "GIC DJOUMA", tel: "—", zone: "Bamguel, Maroua", region: "Extreme nord", lat: 10.8, lng: 14.05},
        {name: "NDOUMESSI", tel: "—", zone: "Kribi, Centre", region: "Sud", lat: 2.925, lng: 9.9167},
        {name: "GIC PRODUCTEURS DES OIGNONS", tel: "—", zone: "Nord", region: "Nord", lat: 10.61, lng: 14.37},
        {name: "GIC PRODUCTEURS DES PEPINIERES DE MAYO-LOUE", tel: "699701299", zone: "Nord", region: "Nord", lat: 8.2410564, lng: 13.2174246},
        {name: "GIC MADINA DES PRODUCTEURS DES CULTURES MARAICHERES DE BARGARAM", tel: "652591465", zone: "Ilarifa, Extreme nord", region: "Extreme nord", lat: 12.440000, lng: 14.950000},
        {name: "groupe des élèves de Volaille de Rouge", tel: "676502725", zone: "Donry-BENOUE", region: "Nord", lat: 10.74028, lng: 13.80278},
        {name: "Société coopérative simplifiée des éleveurs de poulet, de chair", tel: "691772660", zone: "NASSARAO-GAROUA", region: "Nord", lat: 9.333333, lng: 13.18333},
        {name: "Mandu, à Wawo, épouse Mbakom", tel: "696112432", zone: "foumbot", region: "Ouest", lat: 5.563333, lng: 10.66833},
        {name: "GROUPE D'INITIATIVE COMMUNE DES PRODUCTEURS ET COMMERCANTS DES FRUITS DU MAYO-DANAY", tel: "698252640", zone: "Caïcaï, dans le quartier Mangal(maroua)", region: "Extreme nord", lat: 10.6667589, lng: 15.0284567},
        {name: "SCOOPS PROD. MAÏS ET OIGNONS KOZA", tel: "696676662", zone: "Caïcaï, dans le quartier Mangal(maroua)", region: "Extreme nord", lat: 10.6667589, lng: 15.0284567},
        {name: "SOCIETE COOPERATIVE AVEC CONSEIL D'ADMINISTRATION DES PRODUCTEURS D'OIGNON DE NGONG", tel: "695245414", zone: "Tamoundé, en allant vers Tukalongo", region: "Nord", lat: 9.1833, lng: 13.1833},
        {name: "Société des Producteurs d'Oignons", tel: "69000012", zone: "Dockbar, en allant vers Tamoundé", region: "Nord", lat: 10.7336, lng: 14.60928},
        {name: "NOPING", tel: "691027853", zone: "DOUALA", region: "Littoral", lat: 4.03, lng: 9.7},
        {name: "Sanaga Farms", tel: "699612687", zone: "BAFOUSSAM", region: "Ouest", lat: 5.47775, lng: 10.41759},
        {name: "Madame Saïz épouse Wemny", tel: "677766234 / 696606480", zone: "Yaoundé et à Ebolowa", region: "Sud", lat: 2.916664, lng: 11.15},
        {name: "Coopérative d'éleveurs de canards et de poulets de Bupindi", tel: "674853303", zone: "Bipindi", region: "Sud", lat: 3.083333, lng: 10.41666},
        {name: "TIOMELA CLOTILDE", tel: "675151364", zone: "foumbot", region: "Ouest", lat: 5.383611, lng: 10.65639},
        {name: "GROUPE D'INITIATIVE COMMUNE DE FABRICATION NATURELLE DE YAOURT DU LITTORAL CENTRE", tel: "699788027", zone: "Littoral", region: "Littoral", lat: 4.078833, lng: 9.793694},
        {name: "GIC DES PRODUCTRICES DE MANIOC", tel: "678227820", zone: "Littoral", region: "Littoral", lat: 4.051389, lng: 9.685556},
        {name: "LYCEE DE GARI-GOMBO", tel: "651942556", zone: "Littoral", region: "Littoral", lat: 4.016667, lng: 9.716667},
        {name: "SOCIETE COOPERATIVE AVEC CONSEIL D'ADMINISTRATION AGROPASTORALE DES ACTEURS DU DEVELOPPEMENT DE NITOUKOU", tel: "677750389", zone: "Tshukou", region: "Extreme nord", lat: 10.58333, lng: 14.31667},
        {name: "Groupe Initiatives Communes Agropastoral", tel: "677-76-6234 / 696-60-6480", zone: "FOUMBOT", region: "Ouest", lat: 5.503, lng: 10.637},
        {name: "SOCIETE COOPERATIVE SIMPLIFIEE RECOLTE 237 FERME NKOUE", tel: "690767345", zone: "Centre", region: "Centre", lat: 7.365302, lng: 12.343439},
        {name: "SOCIÉTÉ COOPERATIVE SIMPLIFIEE DES PRODUCTEURS DE PATATE DE BONJONG", tel: "697324852", zone: "Adamaoua", region: "Adamaoua", lat: 6.333661, lng: 13.53071},
        {name: "SCOOPS PTASPL", tel: "656102611", zone: "yaoundé", region: "Centre", lat: 3.938333, lng: 11.51556},
        {name: "SOCIETE COOPERATIVE AVEC CONSEIL D'ADMINISTRATION DES PRODUCTEURS DE MANIOC WARACK MADIKOUM", tel: "696492700", zone: "Adamaoua", region: "Adamaoua", lat: 10.58333, lng: 13.18333},
        {name: "Leprince", tel: "698843700", zone: "—", region: "—", lat: null, lng: null}, // pas de coordonnées
        {name: "STE COOP-CA DE PRODUCTION ET TRANSFORMATION DE MANIOC ET ACTIVITÉS CONNEXES DE MBANGASSINA", tel: "675493737", zone: "—", region: "Centre", lat: 4.629722, lng: 11.70694},
        {name: "SOCIETE COOPÉRATIVE AVEC CONSEIL D'ADMINISTRATION DES PRODUCTEURS DE MANIOC SAPE DE BERTOUA", tel: "691977154", zone: "Bertoua", region: "Est", lat: 4.575, lng: 13.68444},
        {name: "coopacam", tel: "699814462", zone: "MFOU", region: "Centre", lat: 4.45, lng: 11.63333},
        {name: "SCOOP MAN DE MBALMAYO", tel: "696819231", zone: "Mbalmayo", region: "Centre", lat: 3.516667, lng: 11.5},
        {name: "Maraiamou", tel: "696255220", zone: "Maroua", region: "Extreme Nord", lat: 10.58333, lng: 14.31667},
        {name: "Groupe produccteur de poisson", tel: "682247271", zone: "Benbis à sangmelina", region: "Sud", lat: 3.433333, lng: 12.45},
        {name: "Vente poisson fumé", tel: "695752643", zone: "Bertoua", region: "Est", lat: 4.575, lng: 13.68444},
        {name: "Vente poulet fumé", tel: "695752643", zone: "Bertoua", region: "Est", lat: 4.575, lng: 13.68444},
        {name: "Gic producteur de Haricot", tel: "67038821", zone: "Foumbot", region: "Ouest", lat: 5.503, lng: 10.637},
        {name: "integrity-fruits", tel: "—", zone: "Douala", region: "Littoral", lat: 4.078889, lng: 9.666667},
        {name: "Gic producteur de poisson Henri Samet", tel: "699 90 92 98", zone: "Kribi, Centre", region: "Centre", lat: 2.845556, lng: 9.885556},
        {name: "makou-epse-fotsing-delphine", tel: "—", zone: "Douala", region: "Littoral", lat: 4.016667, lng: 9.733333},
        {name: "organisation interprofessionnelle de la filière lait de vaches au Cameroun", tel: "698319292", zone: "TCHABAM-FARO", region: "Nord", lat: 9.3226016, lng: 13.393389},
        {name: "Mélanie Tekaneng", tel: "698336566", zone: "Bertoua", region: "Est", lat: 4.575, lng: 13.68444},
        {name: "Moisso-Michel", tel: "694884692", zone: "KRIBI", region: "Sud", lat: 2.845556, lng: 9.885556},
        {name: "Pompou Mangac", tel: "697181400", zone: "mbang-BATOURI", region: "Est", lat: 4.433333, lng: 14.36667},
        {name: "société coopérative", tel: "656 02 80 82", zone: "NDOM,AKONOLINGA", region: "Centre", lat: 3.766667, lng: 12.25},
        {name: "NYANO Patrice", tel: "699936505", zone: "Nkolbisson YAOUNDE", region: "Centre", lat: 3.871944, lng: 11.455},
        {name: "KINDAG adlist sarl", tel: "653 90 79 49", zone: "Makak Centre", region: "Centre", lat: 3.548611, lng: 11.02778},
        {name: "société Harris Yaourt", tel: "670 10 09 31", zone: "Yaoundé Ngoa ékelle", region: "Centre", lat: 3.986111, lng: 11.83306},
        {name: "SCOOPS C.A.B.K.J", tel: "690 777 710", zone: "Ngaoundéré", region: "Adamaoua", lat: 7.316667, lng: 13.58333},
        {name: "GIC FAPAC DE MFOU", tel: "699989564", zone: "Mfou", region: "Centre", lat: 4.45, lng: 11.63333},
        {name: "OMBOLO BELLA du GIC JAEO d’Obala", tel: "678200307", zone: "Obala", region: "Centre", lat: 4.166667, lng: 11.53333},
        {name: "ETS AGRITECH YAOUNDE", tel: "670545408", zone: "Yaoundé odza", region: "Centre", lat: 3.783333, lng: 11.53333},
        {name: "Gic nel-agro", tel: "69995991", zone: "Nkolafamba", region: "Centre", lat: 3.858889, lng: 11.66472},
        {name: "GIC ESPERANCE", tel: "675820484", zone: "—", region: "—", lat: null, lng: null}, // pas de coordonnées
        {name: "GIC AIDONS NOUS D'OBALA", tel: "656529861", zone: "EKOUMDOUM", region: "Centre", lat: 3.816667, lng: 11.53333},
        {name: "BANANA GROUP", tel: "677649089", zone: "Simaleng yaoundé", region: "Centre", lat: 3.720164, lng: 11.552},
        {name: "SCOOPS SAPAS", tel: "693521000", zone: "Guidè au nord", region: "Nord", lat: 36.8065, lng: 10.18156},
        {name: "GIC AGRONE de Nanga Eboko", tel: "673434672/679229967", zone: "Nanga Eboko", region: "Centre", lat: 4.683333, lng: 12.36667},
        {name: "GIC LA RESERVE, à Djoandjila", tel: "694 16 99 10", zone: "Djoandjila", region: "", lat: null, lng: null},
        {name: "GIC MAIN VERTE, à Batchenga", tel: "699428768", zone: "Batchenga", region: "Centre", lat: 4.283333, lng: 11.65},
        {name: "GIC UNION FAIT LA FORCE DE PANGARI", tel: "677 64 70 25", zone: "PANGARI", region: "Adamaoua", lat: 6.01, lng: 13.3625},
        {name: "AGRIDEVERT", tel: "6.53E+08", zone: "ADAMAWA / BANQUIM", region: "Adamaoua", lat: 6.2833, lng: 11.1333},
        {name: "GKIBIA AGROPORT", tel: "674158302", zone: "ADAMAWA / BANQUIM", region: "Adamaoua", lat: 6.15, lng: 11.45},
        {name: "BEGEL SARL à Mindourou", tel: "699 771 423/696 006 048", zone: "Mindourou", region: "Est", lat: 3.4158, lng: 13.5394},
        {name: "L'UNION DES SOCIETES COOPERATIVES AVEC CONSEIL D'ADMINISTRATION DES TRANSFORMATEURS DE LAIT DE MAROUA 1ER", tel: "696154363", zone: "Nord", region: "Nord", lat: 9.3226016, lng: 13.393389}
    ];

    // Compteur pour numéroter UNIQUEMENT les marqueurs réellement affichés
    let uniqueNumberCounter = 1;

    // On parcourt toutes les entrées valides (avec coordonnées)
    locations.forEach(function(loc) {
        if (loc.lat === null || loc.lng === null) return; // on ignore ceux sans coordonnées

        // Numéro unique incrémental (indépendant des doublons de position)
        const markerNumber = uniqueNumberCounter++;
        const colorIndex = (markerNumber - 1) % colors.length;
        const borderColor = colors[colorIndex];

        // Création du marqueur numéroté
        const iconHtml = `
            <div class="numbered-marker">
                <div class="marker-circle" style="border-color:${borderColor};background:${borderColor};color:white;">
                    ${markerNumber}
                </div>
            </div>`;

        const customIcon = L.divIcon({
            html: iconHtml,
            className: "",
            iconSize: [34, 34],
            iconAnchor: [17, 34],
            popupAnchor: [0, -34]
        });

        const marker = L.marker([loc.lat, loc.lng], { icon: customIcon }).addTo(map);

        // Popup
        const popupContent = `
            <div style="font-size:14px;">
                <b>${loc.name}</b><br>
                Région : ${loc.region || "—"}<br>
                Zone : ${loc.zone || "—"}<br>
                Tél : ${loc.tel || "—"}
            </div>`;
        marker.bindPopup(popupContent);

        // Ajout dans la légende
        const li = document.createElement("li");
        li.innerHTML = `<span style="display:inline-block;width:20px;text-align:center;color:white;background:${borderColor};border-radius:50%;padding:2px 6px;margin-right:8px;font-weight:bold;">${markerNumber}</span> ${loc.name}`;
        li.style.cursor = "pointer";
        li.onclick = () => {
            map.setView([loc.lat, loc.lng], 14);
            marker.openPopup();
        };
        document.getElementById("keyList").appendChild(li);
    });
</script>
</html>
